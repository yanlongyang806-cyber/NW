#include "ps_inc.hlsl"
#include "depth_inc.hlsl"
#include "light_inc.hlsl"

SAMPLER_DECL(depth_sampler, 0);

PS_CONSTANT_MATERIAL_BUFFER_START()
uniform float4 object_depth : PS_CONSTANT_MATERIAL_PARAM0() ;
PS_CONSTANT_MATERIAL_BUFFER_END()

// -----------------------------------------------------------------------

struct PS_OUTPUT
{
	float4 color : SEM_COLOR(0);
};

PS_OUTPUT main_output(PS_INPUT_SIMPLE fragment)
{
	PS_OUTPUT output;

	float3 position_vs;
	{
		float z_screen = sampleTexDepth(depth_sampler, fragment.texcoord.xy);

		output.color = float4( 1, 1, 1, 1 );
		if ( object_depth.x > z_screen )
		{
			output.color.rgba = 0.0f;
			output.color.a = 0.1f;
		}
	}

	return output;
}


