// WorldSpaceNormal.phl
{
	#ifndef DEPTH_ONLY
		#ifdef NO_NORMALMAP
			float3 N_vs = normal_vs;
		#else
			#ifdef NORMAL_PRECALCULATED
				float3 N_vs = %Normal%.xyz;
			#else
				float3 N_vs = fromTangentSpace(tangent_vs, binormal_vs, normal_vs, %Normal%.xyz);
			#endif
		#endif
		%Result% = float4(normalize(comul_invview_mat(N_vs)),0);
	#else
		%Result% = float4(normalize(comul_invview_mat(normal_vs)),0);
	#endif
}